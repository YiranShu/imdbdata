<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Results | Movie Genres</title>
  <meta name="description" content="Chapter 5 Results | Movie Genres" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Results | Movie Genres" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Results | Movie Genres" />
  
  
  

<meta name="author" content="Yiran Shu, Qingyi Zhang, Tianxiang Li" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missing-values-1.html"/>
<link rel="next" href="interactive-component.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Movie Genres</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-have-the-genres-of-movies-been-changing-since-last-century"><i class="fa fa-check"></i><b>1.1</b> How have the genres of movies been changing since last century?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#what-was-the-relationship-between-genres-and-ratings-for-example-what-genres-were-more-likely-to-gain-higher-ratings"><i class="fa fa-check"></i><b>1.2</b> What was the relationship between genres and ratings? For example, what genres were more likely to gain higher ratings?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#for-each-director-did-heshe-have-a-preference-in-any-genres"><i class="fa fa-check"></i><b>1.3</b> For each director, did he/she have a preference in any genres?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#url-of-data-sources"><i class="fa fa-check"></i><b>2.1</b> URL of data sources</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#basic-information"><i class="fa fa-check"></i><b>2.2</b> Basic information</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-sources.html"><a href="data-sources.html#title.basics"><i class="fa fa-check"></i><b>2.2.1</b> title.basics</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-sources.html"><a href="data-sources.html#name.basics"><i class="fa fa-check"></i><b>2.2.2</b> name.basics</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-sources.html"><a href="data-sources.html#title.ratings"><i class="fa fa-check"></i><b>2.2.3</b> title.ratings</a></li>
<li class="chapter" data-level="2.2.4" data-path="data-sources.html"><a href="data-sources.html#title.crew"><i class="fa fa-check"></i><b>2.2.4</b> title.crew</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#issues"><i class="fa fa-check"></i><b>2.3</b> Issues</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#missing-values"><i class="fa fa-check"></i><b>3.1</b> Missing values</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-transformation.html"><a href="data-transformation.html#initial-data"><i class="fa fa-check"></i><b>3.1.1</b> Initial data</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-transformation.html"><a href="data-transformation.html#replace-n-with-na"><i class="fa fa-check"></i><b>3.1.2</b> Replace “\\N” with NA</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-transformation.html"><a href="data-transformation.html#data-after-transformation-of-missing-values"><i class="fa fa-check"></i><b>3.1.3</b> Data after transformation of missing values</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#correct-data-type-of-columns"><i class="fa fa-check"></i><b>3.2</b> Correct data type of columns</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#genres"><i class="fa fa-check"></i><b>3.3</b> Genres</a></li>
<li class="chapter" data-level="3.4" data-path="data-transformation.html"><a href="data-transformation.html#save-the-transformed-dataframes"><i class="fa fa-check"></i><b>3.4</b> Save the transformed dataframes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values-1.html"><a href="missing-values-1.html"><i class="fa fa-check"></i><b>4</b> Missing values</a>
<ul>
<li class="chapter" data-level="4.1" data-path="missing-values-1.html"><a href="missing-values-1.html#title.bacis"><i class="fa fa-check"></i><b>4.1</b> title.bacis</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="missing-values-1.html"><a href="missing-values-1.html#missing-values-by-column"><i class="fa fa-check"></i><b>4.1.1</b> Missing values by column</a></li>
<li class="chapter" data-level="4.1.2" data-path="missing-values-1.html"><a href="missing-values-1.html#missing-patterns"><i class="fa fa-check"></i><b>4.1.2</b> Missing patterns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#movie-ratings-of-different-years"><i class="fa fa-check"></i><b>5.1</b> Movie ratings of different years</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="results.html"><a href="results.html#ratings-for-all-movies"><i class="fa fa-check"></i><b>5.1.1</b> Ratings for all movies</a></li>
<li class="chapter" data-level="5.1.2" data-path="results.html"><a href="results.html#rating-distributions-for-100-best-movies"><i class="fa fa-check"></i><b>5.1.2</b> Rating distributions for 100 best movies</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#number-of-votes"><i class="fa fa-check"></i><b>5.2</b> Number of votes</a></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#dependency-between-votes-ratings-and-runtime"><i class="fa fa-check"></i><b>5.3</b> Dependency between votes, ratings and runtime</a></li>
<li class="chapter" data-level="5.4" data-path="results.html"><a href="results.html#movie-titles"><i class="fa fa-check"></i><b>5.4</b> Movie titles</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="results.html"><a href="results.html#most-common-words-in-titles"><i class="fa fa-check"></i><b>5.4.1</b> Most common words in titles</a></li>
<li class="chapter" data-level="5.4.2" data-path="results.html"><a href="results.html#length-of-titles"><i class="fa fa-check"></i><b>5.4.2</b> Length of Titles</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="results.html"><a href="results.html#analysis-of-director"><i class="fa fa-check"></i><b>5.5</b> Analysis of Director</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="results.html"><a href="results.html#top-10-directors-in-action-genre"><i class="fa fa-check"></i><b>5.5.1</b> Top 10 directors in ‘Action’ genre</a></li>
<li class="chapter" data-level="5.5.2" data-path="results.html"><a href="results.html#distribution-of-genres-for-the-top-10-directors"><i class="fa fa-check"></i><b>5.5.2</b> Distribution of genres for the top 10 directors</a></li>
<li class="chapter" data-level="5.5.3" data-path="results.html"><a href="results.html#average-rating-of-top-10-directors-by-genre"><i class="fa fa-check"></i><b>5.5.3</b> Average rating of top 10 directors by genre</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Movie Genres</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="results" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Results</h1>
<div id="movie-ratings-of-different-years" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Movie ratings of different years</h2>
<div id="ratings-for-all-movies" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Ratings for all movies</h3>
<p>IMDB rating is a good reference if we want to know the quality of different movies. Do different genres have obviously different average ratings? Has the quality of movies changed over time? We can find something from the figure below:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="results.html#cb32-1" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Romance&#39;</span>, <span class="st">&quot;Thriller&quot;</span>,<span class="st">&#39;Crime&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Adventure&#39;</span>, <span class="st">&#39;Biography&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb32-2"><a href="results.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="results.html#cb32-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb32-4"><a href="results.html#cb32-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb32-5"><a href="results.html#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="results.html#cb32-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="results.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(startYear<span class="sc">&lt;=</span><span class="dv">2020</span>,startYear<span class="sc">&gt;=</span><span class="dv">1980</span>, genres.x <span class="sc">%in%</span> main_genres, <span class="fu">is.na</span>(numVotes)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="fu">is.na</span>(averageRating)<span class="sc">==</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="results.html#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalratings=</span>numVotes<span class="sc">*</span>averageRating) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="results.html#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(startYear, genres.x) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="results.html#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rating2=</span><span class="fu">sum</span>(totalratings)<span class="sc">/</span><span class="fu">sum</span>(numVotes), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="results.html#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb32-12"><a href="results.html#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="results.html#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="results.html#cb32-14" aria-hidden="true" tabindex="-1"></a>xlabels <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1980</span><span class="sc">:</span><span class="dv">2020</span>)</span>
<span id="cb32-15"><a href="results.html#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xlabels)){</span>
<span id="cb32-16"><a href="results.html#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">strtoi</span>(xlabels[i])<span class="sc">%%</span><span class="dv">5</span><span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb32-17"><a href="results.html#cb32-17" aria-hidden="true" tabindex="-1"></a>    xlabels[i] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb32-18"><a href="results.html#cb32-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-19"><a href="results.html#cb32-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-20"><a href="results.html#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="results.html#cb32-21" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(startYear, <span class="fu">fct_rev</span>(<span class="fu">factor</span>(genres.x)), <span class="at">fill =</span> rating2)) <span class="sc">+</span></span>
<span id="cb32-22"><a href="results.html#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-23"><a href="results.html#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb32-24"><a href="results.html#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;blue&quot;</span>, <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">title=</span><span class="st">&#39;Weighted </span><span class="sc">\n</span><span class="st"> Rating&#39;</span>)) <span class="sc">+</span></span>
<span id="cb32-25"><a href="results.html#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>xlabels) <span class="sc">+</span></span>
<span id="cb32-26"><a href="results.html#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-27"><a href="results.html#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb32-28"><a href="results.html#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="results.html#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="results.html#cb32-30" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Romance&#39;</span>, <span class="st">&quot;Thriller&quot;</span>,<span class="st">&#39;Crime&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Adventure&#39;</span>, <span class="st">&#39;Biography&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb32-31"><a href="results.html#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="results.html#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="results.html#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="results.html#cb32-34" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> </span>
<span id="cb32-35"><a href="results.html#cb32-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(startYear<span class="sc">&lt;=</span><span class="dv">2020</span>,startYear<span class="sc">&gt;=</span><span class="dv">1980</span>, genres.x <span class="sc">%in%</span> main_genres, <span class="fu">is.na</span>(numVotes)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="fu">is.na</span>(averageRating)<span class="sc">==</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-36"><a href="results.html#cb32-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(startYear, genres.x) <span class="sc">%&gt;%</span></span>
<span id="cb32-37"><a href="results.html#cb32-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rating=</span><span class="fu">mean</span>(averageRating), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-38"><a href="results.html#cb32-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb32-39"><a href="results.html#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="results.html#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="results.html#cb32-41" aria-hidden="true" tabindex="-1"></a>xlabels <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1980</span><span class="sc">:</span><span class="dv">2020</span>)</span>
<span id="cb32-42"><a href="results.html#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xlabels)){</span>
<span id="cb32-43"><a href="results.html#cb32-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">strtoi</span>(xlabels[i])<span class="sc">%%</span><span class="dv">5</span><span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb32-44"><a href="results.html#cb32-44" aria-hidden="true" tabindex="-1"></a>    xlabels[i] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb32-45"><a href="results.html#cb32-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-46"><a href="results.html#cb32-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-47"><a href="results.html#cb32-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-48"><a href="results.html#cb32-48" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(startYear, <span class="fu">fct_rev</span>(<span class="fu">factor</span>(genres.x)), <span class="at">fill =</span> rating)) <span class="sc">+</span></span>
<span id="cb32-49"><a href="results.html#cb32-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-50"><a href="results.html#cb32-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb32-51"><a href="results.html#cb32-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;blue&quot;</span>, <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">title=</span><span class="st">&#39;Avg Rating&#39;</span>)) <span class="sc">+</span></span>
<span id="cb32-52"><a href="results.html#cb32-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span>xlabels) <span class="sc">+</span></span>
<span id="cb32-53"><a href="results.html#cb32-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-54"><a href="results.html#cb32-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb32-55"><a href="results.html#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="results.html#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="results.html#cb32-57" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">/</span> g2  <span class="sc">+</span>    <span class="co"># Create grid of plots with title</span></span>
<span id="cb32-58"><a href="results.html#cb32-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Ratings of different genres&quot;</span>, <span class="at">caption=</span><span class="st">&quot;Year&quot;</span>,</span>
<span id="cb32-59"><a href="results.html#cb32-59" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">plot.caption =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">vjust=</span><span class="dv">6</span>) ))</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>This is an interesting plot about the ratings of different genres changing with time. The top one calculates the average ratings of movies from each genre and each year. It seems that <code>Documentary</code>, <code>Biograph</code> and <code>Music</code> have the highest ratings, while ratings for <code>Horro</code> movies are the lowest. And there is no obvious trend along the <code>Year</code> dimension.</p>
<p>However, let’s consider this situation: there are two <code>Action</code> movies in 2050.One gets 10000 votes of 10 star, one gets gets 1 vote of 0 star. The average rating would be 5 star. This seems a little unfair, right?</p>
<p>So we also use <code>weighted average</code>, where weights are their number of votes, and we get the bottom plot. Surprisingly, the ratings between different genres are not so large as we thought. <code>Documentary</code> and <code>Biography</code> are not much higher than the others, although <code>Horro</code> still seems the lowest.</p>
<p>Another interesting discovery is that there is a trend along time: movies before 2000 clearly have higher weighted ratings than movies after 2000. Maybe this is a reflection that the quality of movies in recent years are not as well as before?</p>
</div>
<div id="rating-distributions-for-100-best-movies" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Rating distributions for 100 best movies</h3>
<p>Now that we have a view of ratings of all movies, what about those top-rating movies? Do people have preference among different genres when they are rating? We select 100 top-rating movies of different genres and plot their distributions:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="results.html#cb33-1" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Romance&#39;</span>, <span class="st">&quot;Thriller&quot;</span>,<span class="st">&#39;Crime&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Adventure&#39;</span>, <span class="st">&#39;Biography&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb33-2"><a href="results.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="results.html#cb33-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb33-4"><a href="results.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="results.html#cb33-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="results.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genres <span class="sc">%in%</span> main_genres, numVotes<span class="sc">&gt;</span><span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="results.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genres) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="results.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r=</span><span class="fu">rank</span>(averageRating<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="results.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="results.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span><span class="dv">100</span>)</span>
<span id="cb33-11"><a href="results.html#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="results.html#cb33-12" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb33-13"><a href="results.html#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="results.html#cb33-14" aria-hidden="true" tabindex="-1"></a>x2<span class="sc">$</span>genres.x <span class="ot">&lt;-</span> <span class="fu">with</span>(x2 ,<span class="fu">reorder</span>(genres.x,averageRating,median))</span>
<span id="cb33-15"><a href="results.html#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="results.html#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="results.html#cb33-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb33-18"><a href="results.html#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="results.html#cb33-19" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb33-20"><a href="results.html#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genres <span class="sc">%in%</span> main_genres) <span class="sc">%&gt;%</span></span>
<span id="cb33-21"><a href="results.html#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genres) <span class="sc">%&gt;%</span></span>
<span id="cb33-22"><a href="results.html#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r=</span><span class="fu">rank</span>(averageRating<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="results.html#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-24"><a href="results.html#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span><span class="dv">100</span>)</span>
<span id="cb33-25"><a href="results.html#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="results.html#cb33-26" aria-hidden="true" tabindex="-1"></a>x22 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb33-27"><a href="results.html#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="results.html#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">#x2$genres.x &lt;- with(x2 ,reorder(genres.x,averageRating,median))</span></span>
<span id="cb33-29"><a href="results.html#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="results.html#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb33-31"><a href="results.html#cb33-31" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb33-32"><a href="results.html#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">data =</span> x2, <span class="fu">aes</span>(<span class="at">y =</span> genres.x, <span class="at">x =</span> averageRating), <span class="at">alpha=</span><span class="fl">0.8</span>,<span class="at">color=</span><span class="st">&#39;white&#39;</span>, <span class="at">fill=</span><span class="st">&#39;lightslateblue&#39;</span>)<span class="sc">+</span></span>
<span id="cb33-33"><a href="results.html#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">data =</span> x22, <span class="fu">aes</span>(<span class="at">y =</span> genres.x, <span class="at">x =</span> averageRating), <span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">color=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">alpha=</span><span class="dv">0</span>, <span class="at">maxColorValue =</span> <span class="dv">1</span>),</span>
<span id="cb33-34"><a href="results.html#cb33-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb33-35"><a href="results.html#cb33-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb33-36"><a href="results.html#cb33-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Rating distributions for 100 top-rating movies of each genre&#39;</span>)</span>
<span id="cb33-37"><a href="results.html#cb33-37" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>If we select movies from all of them, we get the red distributions. But if we only consider movies with more than 5000 votes, we get the purple ones. We find that <code>Documentary</code> has the highest median if we consider all movies, but it gets lower if we exclude those without enough votes. It turns out that there are many documentary movies only have 20 or 50 votes with almost 10 star ratings. It’s the same with biography and music movies.</p>
<p>If we exclude these not well-known works, we can get a picture of the preferences of the most population. It shows that people tend to give higher ratings for <code>Romance</code> movies, while it’s very hard for <code>Horro</code> movies to get high scores.</p>
</div>
</div>
<div id="number-of-votes" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Number of votes</h2>
<p>As we can see, those movies with few votes can cause big difference when we are analysing the data. What are these movies like? We select those movies with less than 5,000 votes on IMDB and see where they come from:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="results.html#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb34-2"><a href="results.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="results.html#cb34-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="results.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numVotes<span class="sc">&lt;</span><span class="dv">5000</span>)</span>
<span id="cb34-5"><a href="results.html#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="results.html#cb34-6" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb34-7"><a href="results.html#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="results.html#cb34-8" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> x2 <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="results.html#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genres.x) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="results.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">c=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="results.html#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb34-12"><a href="results.html#cb34-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-13"><a href="results.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb34-14"><a href="results.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(x3, <span class="at">index=</span><span class="st">&quot;genres.x&quot;</span>, <span class="at">vSize=</span><span class="st">&quot;c&quot;</span>, <span class="at">type=</span><span class="st">&quot;index&quot;</span>,</span>
<span id="cb34-15"><a href="results.html#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&#39;Movies (votes&lt;5000)&#39;</span>,<span class="at">fontsize.title=</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>These movies mostly come from <code>Drama</code>, <code>Comedy</code>, <code>Documentary</code>, which is not very surprising. However, we can sense that they may have different ratings, because when we exclude these movies, the average ratings of different genres change differently.</p>
<p>So now we plot the ratings of these movies and get this:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="results.html#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb35-2"><a href="results.html#cb35-2" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Documentary&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Drama&#39;</span>)</span>
<span id="cb35-3"><a href="results.html#cb35-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="results.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numVotes<span class="sc">&lt;</span><span class="dv">5000</span>,numVotes<span class="sc">&gt;</span><span class="dv">0</span>, genres <span class="sc">%in%</span> main_genres)</span>
<span id="cb35-5"><a href="results.html#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="results.html#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="results.html#cb35-7" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="cf">function</span>(r){</span>
<span id="cb35-8"><a href="results.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (r<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> r<span class="sc">&lt;</span><span class="dv">4</span>) <span class="fu">return</span>(<span class="st">&#39;0-4&#39;</span>)</span>
<span id="cb35-9"><a href="results.html#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (r<span class="sc">&gt;=</span><span class="dv">4</span> <span class="sc">&amp;</span> r<span class="sc">&lt;</span><span class="dv">6</span>) <span class="fu">return</span>(<span class="st">&#39;4-6&#39;</span>)</span>
<span id="cb35-10"><a href="results.html#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (r<span class="sc">&gt;=</span><span class="dv">6</span> <span class="sc">&amp;</span> r<span class="sc">&lt;</span><span class="dv">8</span>) <span class="fu">return</span>(<span class="st">&#39;6-8&#39;</span>)</span>
<span id="cb35-11"><a href="results.html#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (r<span class="sc">&gt;=</span><span class="dv">8</span> <span class="sc">&amp;</span> r<span class="sc">&lt;=</span><span class="dv">10</span>) <span class="fu">return</span>(<span class="st">&#39;8-10&#39;</span>)</span>
<span id="cb35-12"><a href="results.html#cb35-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-13"><a href="results.html#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="results.html#cb35-14" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>rating1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x1<span class="sc">$</span>averageRating, cl)</span>
<span id="cb35-15"><a href="results.html#cb35-15" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>rating2 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(x1<span class="sc">$</span>rating1)</span>
<span id="cb35-16"><a href="results.html#cb35-16" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>Rating <span class="ot">&lt;-</span> <span class="fu">fct_rev</span>(<span class="fu">factor</span>(x1<span class="sc">$</span>rating2))</span>
<span id="cb35-17"><a href="results.html#cb35-17" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>genres <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1<span class="sc">$</span>genres)</span>
<span id="cb35-18"><a href="results.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">#levels(x1$genres) &lt;- c(&#39;Documentary&#39;, &#39;Drama&#39;,&#39;Crime&#39;,&#39;Action&#39;,&#39;Horror&#39;)</span></span>
<span id="cb35-19"><a href="results.html#cb35-19" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>Genre <span class="ot">&lt;-</span> <span class="fu">fct_rev</span>(<span class="fu">fct_relevel</span>(x1<span class="sc">$</span>genres,<span class="st">&#39;Documentary&#39;</span>, <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Action&#39;</span>,<span class="st">&#39;Horror&#39;</span>))</span>
<span id="cb35-20"><a href="results.html#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="results.html#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lock5withR)</span>
<span id="cb35-22"><a href="results.html#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb35-23"><a href="results.html#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic</span>(Rating<span class="sc">~</span>Genre, <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">&quot;v&quot;</span>,<span class="st">&quot;h&quot;</span>),x1,<span class="at">main=</span><span class="st">&#39;Ratings of movies (votes&lt;5000)&#39;</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-42-1.png" width="768" /></p>
<p>As we can see, among these movies, <code>Documentary</code> mostly have 6-8 stars, while <code>Horro</code> movies mostly have 0-6 stars. This proves what we think: there exists many documentary movies with small number of votes but very high ratings.</p>
</div>
<div id="dependency-between-votes-ratings-and-runtime" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Dependency between votes, ratings and runtime</h2>
<p>Now we may wonder if votes and ratings have some relationship. The graph below shows the relationship among three variables: votes, ratings, and runtime. Note that we only select popular movies (with number of votes larger than 200,000) to exclude those ‘noisy’ less popular movies.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="results.html#cb36-1" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>,<span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb36-2"><a href="results.html#cb36-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.basics, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb36-3"><a href="results.html#cb36-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>runtimeMinutes <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(x<span class="sc">$</span>runtimeMinutes)</span>
<span id="cb36-4"><a href="results.html#cb36-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>numVotes <span class="ot">&lt;-</span> x<span class="sc">$</span>numVotes<span class="sc">/</span><span class="fl">1e3</span></span>
<span id="cb36-5"><a href="results.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="results.html#cb36-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x<span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="results.html#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genres <span class="sc">%in%</span> main_genres,<span class="fu">is.na</span>(runtimeMinutes)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="fu">is.na</span>(averageRating)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="fu">is.na</span>(numVotes)<span class="sc">==</span><span class="cn">FALSE</span>, runtimeMinutes<span class="sc">&lt;</span><span class="dv">400</span>,startYear<span class="sc">&gt;=</span><span class="dv">1940</span>,startYear<span class="sc">&lt;=</span><span class="dv">2020</span>, numVotes<span class="sc">&gt;</span><span class="dv">200</span>)</span>
<span id="cb36-8"><a href="results.html#cb36-8" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>votes_in_thousand <span class="ot">&lt;-</span> x1<span class="sc">$</span>numVotes</span>
<span id="cb36-9"><a href="results.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-10"><a href="results.html#cb36-10" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">%&gt;%</span><span class="fu">select</span>(runtimeMinutes, averageRating, votes_in_thousand)</span>
<span id="cb36-11"><a href="results.html#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb36-12"><a href="results.html#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(x2, <span class="fu">aes</span>(<span class="at">alpha=</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>The average rating and number of votes have obvious relationship. This is not difficult to understand: better movies are usually more popular so more people would vote. We also find that longer movies tend to have higher ratings. This is an interesting discovery. One reason could be that longer movies usually come from those with meaningful topics, while entertainment movies are usually shorter.</p>
</div>
<div id="movie-titles" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Movie titles</h2>
<div id="most-common-words-in-titles" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Most common words in titles</h3>
<p>Do movies of different genres prefer different words in titles? For example, maybe there are a lot of <code>heart</code> in <code>Romance</code> movies titles? Here we select 15 most common words from <code>Action</code>, <code>Animation</code>, <code>Romance</code>, <code>Sci_Fi</code> (meaningless words like ‘the’, ‘to’ are excluded):</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="results.html#cb37-1" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Romance&#39;</span>, <span class="st">&quot;Thriller&quot;</span>,<span class="st">&#39;Crime&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Adventure&#39;</span>, <span class="st">&#39;Biography&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb37-2"><a href="results.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="results.html#cb37-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb37-4"><a href="results.html#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="results.html#cb37-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="results.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(startYear<span class="sc">&gt;=</span><span class="dv">1990</span>, startYear<span class="sc">&lt;=</span><span class="dv">2020</span>)</span>
<span id="cb37-7"><a href="results.html#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="results.html#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="results.html#cb37-9" aria-hidden="true" tabindex="-1"></a>WordFreq <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb37-10"><a href="results.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">=</span> text[text<span class="sc">!=</span><span class="st">&quot;&quot;</span>]</span>
<span id="cb37-11"><a href="results.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">=</span> <span class="fu">tolower</span>(txt)</span>
<span id="cb37-12"><a href="results.html#cb37-12" aria-hidden="true" tabindex="-1"></a>  txtList <span class="ot">=</span> <span class="fu">lapply</span>(txt, strsplit,<span class="st">&quot; &quot;</span>)</span>
<span id="cb37-13"><a href="results.html#cb37-13" aria-hidden="true" tabindex="-1"></a>  txtChar <span class="ot">=</span> <span class="fu">unlist</span>(txtList)</span>
<span id="cb37-14"><a href="results.html#cb37-14" aria-hidden="true" tabindex="-1"></a>  txtChar <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.|,|</span><span class="sc">\\</span><span class="st">!|:|;|</span><span class="sc">\\</span><span class="st">?&quot;</span>,<span class="st">&quot;&quot;</span>,txtChar) <span class="co">#clean symbol(.,!:;?)</span></span>
<span id="cb37-15"><a href="results.html#cb37-15" aria-hidden="true" tabindex="-1"></a>  txtChar <span class="ot">=</span> txtChar[txtChar<span class="sc">!=</span><span class="st">&quot;&quot;</span>]</span>
<span id="cb37-16"><a href="results.html#cb37-16" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(txtChar))</span>
<span id="cb37-17"><a href="results.html#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Word&quot;</span>,<span class="st">&quot;freq&quot;</span>)</span>
<span id="cb37-18"><a href="results.html#cb37-18" aria-hidden="true" tabindex="-1"></a>  ordFreq <span class="ot">=</span> data[<span class="fu">order</span>(data<span class="sc">$</span>freq,<span class="at">decreasing=</span>T),]</span>
<span id="cb37-19"><a href="results.html#cb37-19" aria-hidden="true" tabindex="-1"></a>  meaningless <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;the&#39;</span>,<span class="st">&#39;of&#39;</span>,<span class="st">&#39;a&#39;</span>,<span class="st">&#39;and&#39;</span>,<span class="st">&#39;2&#39;</span>,<span class="st">&#39;3&#39;</span>,<span class="st">&#39;in&#39;</span>,<span class="st">&#39;movie&#39;</span>,<span class="st">&#39;an&#39;</span>,<span class="st">&#39;last&#39;</span>,<span class="st">&#39;i&#39;</span>,<span class="st">&#39;you&#39;</span>,<span class="st">&#39;my&#39;</span>,<span class="st">&#39;me&#39;</span>,<span class="st">&#39;man&#39;</span>,<span class="st">&#39;en&#39;</span>,<span class="st">&#39;del&#39;</span>,<span class="st">&#39;le&#39;</span>,<span class="st">&#39;un&#39;</span>,<span class="st">&#39;der&#39;</span>,<span class="st">&#39;les&#39;</span>,<span class="st">&#39;to&#39;</span>,<span class="st">&#39;one&#39;</span>,<span class="st">&#39;no&#39;</span>,<span class="st">&#39;not&#39;</span>,<span class="st">&#39;it&#39;</span>,<span class="st">&#39;from&#39;</span>,<span class="st">&#39;-&#39;</span>,<span class="st">&#39;de&#39;</span>,<span class="st">&#39;la&#39;</span>,<span class="st">&#39;el&#39;</span>,<span class="st">&#39;&amp;&#39;</span>,<span class="st">&#39;for&#39;</span>,<span class="st">&#39;on&#39;</span>,<span class="st">&#39;is&#39;</span>,<span class="st">&#39;with&#39;</span>,<span class="st">&#39;at&#39;</span>,<span class="st">&#39;ka&#39;</span>,<span class="st">&#39;ii&#39;</span>,<span class="st">&#39;ang&#39;</span>,<span class="st">&#39;up&#39;</span>,<span class="st">&#39;ng&#39;</span>,<span class="st">&#39;na&#39;</span>,<span class="st">&#39;your&#39;</span>)</span>
<span id="cb37-20"><a href="results.html#cb37-20" aria-hidden="true" tabindex="-1"></a>  ordFreq <span class="ot">&lt;-</span> ordFreq <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(Word <span class="sc">%in%</span> meaningless))</span>
<span id="cb37-21"><a href="results.html#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ordFreq)</span>
<span id="cb37-22"><a href="results.html#cb37-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-23"><a href="results.html#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="results.html#cb37-24" aria-hidden="true" tabindex="-1"></a>text <span class="ot">=</span> x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genres.x<span class="sc">==</span><span class="st">&#39;Romance&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-25"><a href="results.html#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle)</span>
<span id="cb37-26"><a href="results.html#cb37-26" aria-hidden="true" tabindex="-1"></a>ordFreq1 <span class="ot">&lt;-</span> <span class="fu">WordFreq</span>(text)</span>
<span id="cb37-27"><a href="results.html#cb37-27" aria-hidden="true" tabindex="-1"></a>ordFreq1<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="st">&#39;Romance&#39;</span> </span>
<span id="cb37-28"><a href="results.html#cb37-28" aria-hidden="true" tabindex="-1"></a>text <span class="ot">=</span> x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genres.x<span class="sc">==</span><span class="st">&#39;Action&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-29"><a href="results.html#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle)</span>
<span id="cb37-30"><a href="results.html#cb37-30" aria-hidden="true" tabindex="-1"></a>ordFreq2 <span class="ot">&lt;-</span> <span class="fu">WordFreq</span>(text)</span>
<span id="cb37-31"><a href="results.html#cb37-31" aria-hidden="true" tabindex="-1"></a>ordFreq2<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="st">&#39;Action&#39;</span></span>
<span id="cb37-32"><a href="results.html#cb37-32" aria-hidden="true" tabindex="-1"></a>text <span class="ot">=</span> x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genres.x<span class="sc">==</span><span class="st">&#39;Animation&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-33"><a href="results.html#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle)</span>
<span id="cb37-34"><a href="results.html#cb37-34" aria-hidden="true" tabindex="-1"></a>ordFreq3 <span class="ot">&lt;-</span> <span class="fu">WordFreq</span>(text)</span>
<span id="cb37-35"><a href="results.html#cb37-35" aria-hidden="true" tabindex="-1"></a>ordFreq3<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="st">&#39;&#39;</span></span>
<span id="cb37-36"><a href="results.html#cb37-36" aria-hidden="true" tabindex="-1"></a>text <span class="ot">=</span> x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genres.x<span class="sc">==</span><span class="st">&#39;Sci-Fi&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-37"><a href="results.html#cb37-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(primaryTitle)</span>
<span id="cb37-38"><a href="results.html#cb37-38" aria-hidden="true" tabindex="-1"></a>ordFreq4 <span class="ot">&lt;-</span> <span class="fu">WordFreq</span>(text)</span>
<span id="cb37-39"><a href="results.html#cb37-39" aria-hidden="true" tabindex="-1"></a>ordFreq4<span class="sc">$</span>genre <span class="ot">&lt;-</span> <span class="st">&#39;Sci-Fi&#39;</span></span>
<span id="cb37-40"><a href="results.html#cb37-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-41"><a href="results.html#cb37-41" aria-hidden="true" tabindex="-1"></a>ordFreq <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordFreq1[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,], ordFreq2[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,])</span>
<span id="cb37-42"><a href="results.html#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="results.html#cb37-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-44"><a href="results.html#cb37-44" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ordFreq1[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,], <span class="fu">aes</span>(<span class="at">x=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq))) <span class="sc">+</span></span>
<span id="cb37-45"><a href="results.html#cb37-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">xend=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq), <span class="at">yend=</span><span class="fu">fct_reorder</span>(Word, freq)), <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-46"><a href="results.html#cb37-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb37-47"><a href="results.html#cb37-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Guess 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-48"><a href="results.html#cb37-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb37-49"><a href="results.html#cb37-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-50"><a href="results.html#cb37-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-51"><a href="results.html#cb37-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-52"><a href="results.html#cb37-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-53"><a href="results.html#cb37-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb37-54"><a href="results.html#cb37-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-55"><a href="results.html#cb37-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-56"><a href="results.html#cb37-56" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ordFreq2[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,], <span class="fu">aes</span>(<span class="at">x=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq))) <span class="sc">+</span></span>
<span id="cb37-57"><a href="results.html#cb37-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">xend=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq), <span class="at">yend=</span><span class="fu">fct_reorder</span>(Word, freq)), <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-58"><a href="results.html#cb37-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb37-59"><a href="results.html#cb37-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Guess 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-60"><a href="results.html#cb37-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb37-61"><a href="results.html#cb37-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">300</span>,<span class="dv">400</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="st">&quot;&quot;</span>,<span class="dv">200</span>,<span class="st">&quot;&quot;</span>,<span class="dv">400</span>))<span class="sc">+</span></span>
<span id="cb37-62"><a href="results.html#cb37-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-63"><a href="results.html#cb37-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-64"><a href="results.html#cb37-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-65"><a href="results.html#cb37-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-66"><a href="results.html#cb37-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-67"><a href="results.html#cb37-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb37-68"><a href="results.html#cb37-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-69"><a href="results.html#cb37-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-70"><a href="results.html#cb37-70" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ordFreq3[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,], <span class="fu">aes</span>(<span class="at">x=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq))) <span class="sc">+</span></span>
<span id="cb37-71"><a href="results.html#cb37-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">xend=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq), <span class="at">yend=</span><span class="fu">fct_reorder</span>(Word, freq)), <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-72"><a href="results.html#cb37-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb37-73"><a href="results.html#cb37-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Guess 4&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-74"><a href="results.html#cb37-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb37-75"><a href="results.html#cb37-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-76"><a href="results.html#cb37-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-77"><a href="results.html#cb37-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-78"><a href="results.html#cb37-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-79"><a href="results.html#cb37-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-80"><a href="results.html#cb37-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb37-81"><a href="results.html#cb37-81" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-82"><a href="results.html#cb37-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-83"><a href="results.html#cb37-83" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ordFreq4[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,], <span class="fu">aes</span>(<span class="at">x=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq))) <span class="sc">+</span></span>
<span id="cb37-84"><a href="results.html#cb37-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">xend=</span>freq, <span class="at">y=</span><span class="fu">fct_reorder</span>(Word, freq), <span class="at">yend=</span><span class="fu">fct_reorder</span>(Word, freq)), <span class="at">color=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-85"><a href="results.html#cb37-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb37-86"><a href="results.html#cb37-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Guess 3&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-87"><a href="results.html#cb37-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb37-88"><a href="results.html#cb37-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-89"><a href="results.html#cb37-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-90"><a href="results.html#cb37-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-91"><a href="results.html#cb37-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-92"><a href="results.html#cb37-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-93"><a href="results.html#cb37-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb37-94"><a href="results.html#cb37-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-95"><a href="results.html#cb37-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-96"><a href="results.html#cb37-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-97"><a href="results.html#cb37-97" aria-hidden="true" tabindex="-1"></a>ggp_all <span class="ot">&lt;-</span> (g1 <span class="sc">|</span>g2 <span class="sc">|</span> g4 <span class="sc">|</span> g3) <span class="sc">+</span>    <span class="co"># Create grid of plots with title</span></span>
<span id="cb37-98"><a href="results.html#cb37-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Most common words in different genres&#39; titles&quot;</span>, <span class="at">caption=</span><span class="st">&quot;Frequence&quot;</span>,</span>
<span id="cb37-99"><a href="results.html#cb37-99" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">plot.caption =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">vjust=</span><span class="dv">6</span>) ))</span>
<span id="cb37-100"><a href="results.html#cb37-100" aria-hidden="true" tabindex="-1"></a>ggp_all </span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>The genre of each plot is hidden. Can you match these four plots with the four genres?</p>
<p>It should be easy. The first one, with ‘love’ having highest frequency, is <code>Romance</code>. We can also see ‘girl’, ‘heart’, ‘wedding’ in these titles. The second one have ‘vs’, ‘blood’, ‘hero’, so it’s obvious <code>Action</code>. What about ‘alien’, ‘space’, ‘star’? <code>Sci_fi</code> movies love these topics! And lastly, for little children, ‘little’, ‘magic’, ‘christmas’. It must be <code>Animation</code>. Do you get them all right?</p>
<p>Also we can notice that ‘love’ is one of the most common words for many genres. Maybe love is the eternal theme for human!</p>
</div>
<div id="length-of-titles" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Length of Titles</h3>
<p>What’s the average length of movie titles and does it change with time? We plot the average length of titles:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="results.html#cb38-1" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>,<span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb38-2"><a href="results.html#cb38-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb38-3"><a href="results.html#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="results.html#cb38-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="results.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genres.x <span class="sc">%in%</span> main_genres) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="results.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade=</span><span class="fu">strtoi</span>(startYear)<span class="sc">-</span><span class="fu">strtoi</span>(startYear)<span class="sc">%%</span><span class="dv">4</span>)</span>
<span id="cb38-7"><a href="results.html#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="results.html#cb38-8" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>len_title <span class="ot">=</span> <span class="fu">lapply</span>(x1<span class="sc">$</span>primaryTitle, <span class="cf">function</span>(t){<span class="fu">return</span>(<span class="fu">length</span>(<span class="fu">strsplit</span>(t,<span class="st">&quot; &quot;</span>)[[<span class="dv">1</span>]]))})</span>
<span id="cb38-9"><a href="results.html#cb38-9" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>len_title <span class="ot">=</span> <span class="fu">as.integer</span>(x1<span class="sc">$</span>len_title)</span>
<span id="cb38-10"><a href="results.html#cb38-10" aria-hidden="true" tabindex="-1"></a>x1<span class="sc">$</span>genres.x <span class="ot">&lt;-</span> <span class="fu">with</span>(x1 ,<span class="fu">reorder</span>(genres.x,len_title,median))</span>
<span id="cb38-11"><a href="results.html#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="results.html#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="results.html#cb38-13" aria-hidden="true" tabindex="-1"></a>xlabels <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1920</span><span class="sc">:</span><span class="dv">2020</span>)</span>
<span id="cb38-14"><a href="results.html#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xlabels)){</span>
<span id="cb38-15"><a href="results.html#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">strtoi</span>(xlabels[i])<span class="sc">%%</span><span class="dv">10</span><span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb38-16"><a href="results.html#cb38-16" aria-hidden="true" tabindex="-1"></a>    xlabels[i] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb38-17"><a href="results.html#cb38-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-18"><a href="results.html#cb38-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-19"><a href="results.html#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="results.html#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="results.html#cb38-21" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">%&gt;%</span>   <span class="fu">filter</span>(genres.x <span class="sc">%in%</span> main_genres, decade<span class="sc">&gt;=</span><span class="dv">1940</span>, decade<span class="sc">&lt;=</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-22"><a href="results.html#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genres.x, decade) <span class="sc">%&gt;%</span></span>
<span id="cb38-23"><a href="results.html#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">len=</span><span class="fu">mean</span>(len_title),<span class="at">low=</span>len<span class="sc">-</span><span class="fu">sd</span>(len_title)<span class="sc">/</span><span class="dv">30</span>,<span class="at">high=</span>len<span class="sc">+</span><span class="fu">sd</span>(len_title)<span class="sc">/</span><span class="dv">30</span> ,<span class="at">.groups=</span><span class="st">&#39;drop&#39;</span>) </span>
<span id="cb38-24"><a href="results.html#cb38-24" aria-hidden="true" tabindex="-1"></a>x2<span class="sc">$</span>genres.x <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(x2<span class="sc">$</span>genres.x, <span class="st">&#39;Music&#39;</span>, <span class="st">&#39;Documentary&#39;</span>, <span class="st">&#39;Comedy&#39;</span>, <span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb38-25"><a href="results.html#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="results.html#cb38-26" aria-hidden="true" tabindex="-1"></a>x2 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>decade, <span class="at">y=</span>len, <span class="at">color=</span>genres.x))<span class="sc">+</span></span>
<span id="cb38-27"><a href="results.html#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb38-28"><a href="results.html#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Average length of movie titles&#39;</span>)<span class="sc">+</span></span>
<span id="cb38-29"><a href="results.html#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Length&#39;</span>) <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;&#39;</span>)<span class="sc">+</span></span>
<span id="cb38-30"><a href="results.html#cb38-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Genre&quot;</span>))</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>We can see that at first they don’t have much difference, but as time develops <code>Music</code> and <code>Documentary</code> have longer titles with average length of 4, and <code>Comedy</code>, <code>Action</code>, <code>Sci-Fi</code> have shorter average titles. It can also be noticed that their average title length was decreasing from 1970 to 2000, but after 2000 their length has been increasing.</p>
</div>
</div>
<div id="analysis-of-director" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Analysis of Director</h2>
<p>This part we will analyze the relationship between directors and genre types, which contains features of some directors. Do you want to know is there any preference of each director? You will figure out in the following analysis.</p>
<div id="top-10-directors-in-action-genre" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Top 10 directors in ‘Action’ genre</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="results.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb39-2"><a href="results.html#cb39-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> title.genres <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(genres) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="results.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(genres, count), <span class="at">y=</span>count)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="results.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Genres&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of movies&quot;</span>,</span>
<span id="cb39-5"><a href="results.html#cb39-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">title=</span><span class="st">&quot;Number of movies by genres&quot;</span>) </span>
<span id="cb39-6"><a href="results.html#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="results.html#cb39-7" aria-hidden="true" tabindex="-1"></a>top_10 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(title.genres, title.crew, <span class="at">by=</span><span class="st">&quot;tconst&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="results.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(directors)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(genres<span class="sc">==</span><span class="st">&quot;Action&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-9"><a href="results.html#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(name.basics <span class="sc">%&gt;%</span> <span class="fu">select</span>(nconst, primaryName), <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;directors&quot;</span><span class="ot">=</span><span class="st">&quot;nconst&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="results.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(directors, primaryName) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="results.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>) </span>
<span id="cb39-12"><a href="results.html#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="results.html#cb39-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>top_10, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(primaryName, count), <span class="at">y=</span>count)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb39-14"><a href="results.html#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Director&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of movies&quot;</span>, </span>
<span id="cb39-15"><a href="results.html#cb39-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Top 10 directors (Drama)&quot;</span>) </span>
<span id="cb39-16"><a href="results.html#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplotly(p)</span></span>
<span id="cb39-17"><a href="results.html#cb39-17" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(title.genres, title.crew, <span class="at">by=</span><span class="st">&quot;tconst&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="results.html#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(directors))  <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="results.html#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(directors <span class="sc">%in%</span> <span class="fu">c</span>(top_10<span class="sc">$</span>directors[<span class="dv">1</span>], top_10<span class="sc">$</span>directors[<span class="dv">10</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb39-20"><a href="results.html#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(name.basics, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;directors&quot;</span><span class="ot">=</span><span class="st">&quot;nconst&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-21"><a href="results.html#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genres, primaryName) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-22"><a href="results.html#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>genres, <span class="at">y=</span>count,<span class="at">fill=</span>primaryName)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb39-23"><a href="results.html#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&quot;Director&quot;</span>)</span>
<span id="cb39-24"><a href="results.html#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2,p3,  <span class="at">nrow=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-46-1.png" width="1152" /></p>
<p>First, let’s see the most popular genre that directors like to make. Obviouly, it is ‘Drama’, then ‘Documentary’ and ‘Comedy’.</p>
<p>Here I choose ‘Action’ movies to do some specific analysis. Since with the development of technology, more and more directors try to make ‘Action’ moveis in 2D, 3D and 4D. It becomes popular in young people. So Let’s see what we can get from the graphs.</p>
<p>To begin with, you will see the top 10 directors in ‘Action’ genre, the director called Godfrey Ho made about 120 ‘Action’ movies, while other directors only made less than 90 ‘Action’ movies. Does it mean Godfrey has preference in ‘Action’ moveis or he also made a lot of other genres? So here comes to the next graph.</p>
<p>In the next graph, it shows director Godfrey Ho and Francis Posadas, which are the first director and the last director in ‘Action’ genre. You can see from the graph that Godfrey Ho has a strong preference in ‘Action’ movies. As for Francis Posadas, he prefers to make ‘Action’ and ‘Drama’. And both of them made less other genre movies.</p>
</div>
<div id="distribution-of-genres-for-the-top-10-directors" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Distribution of genres for the top 10 directors</h3>
<p>Are you curious about the other genres the top 10 directors in ‘Action’ made? In this part you can see the exact number using your mouse. When you put your mouse on the bar of ‘Action’, you can see the exact number of ‘Action’ movies which is 683.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="results.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(title.genres, title.crew, <span class="at">by=</span><span class="st">&quot;tconst&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="results.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(directors))  <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="results.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(directors <span class="sc">%in%</span> top_10<span class="sc">$</span>directors) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="results.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genres) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="results.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(genres, count), <span class="at">y=</span>count)) <span class="sc">+</span> </span>
<span id="cb40-6"><a href="results.html#cb40-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb40-7"><a href="results.html#cb40-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb40-8"><a href="results.html#cb40-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Genres&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of movies&quot;</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>In the graph, we can see ‘Drama’, ‘Comedy’ and ‘Romance’ follows ‘Action’ movies, which the top 10 directors like to make. It does not match with the overall regular pattern. And only a few directors made 3 ‘Documentary’ movies, which means directors in other geners made a lot of ‘Documentary’ and made it come to the second top number of movies.</p>
</div>
<div id="average-rating-of-top-10-directors-by-genre" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Average rating of top 10 directors by genre</h3>
<p>In this part, the goal I want to achieve is to figure out whether a director like Godfrey Ho made a lot of ‘Action’ moives has higher ratings in ‘Action’ movies than other genres or not. Does it mean the more ‘Action’ movies one director made, the higher rating he could get in ‘Action’ movies? Here I also use two types of ratings, average rating and weighted rating, to avoid unfairness.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="results.html#cb41-1" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Romance&#39;</span>, <span class="st">&quot;Thriller&quot;</span>,<span class="st">&#39;Crime&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Adventure&#39;</span>, <span class="st">&#39;Biography&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb41-2"><a href="results.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="results.html#cb41-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(title.genres, title.basics, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb41-4"><a href="results.html#cb41-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x, title.ratings, <span class="at">by=</span><span class="st">&#39;tconst&#39;</span>)</span>
<span id="cb41-5"><a href="results.html#cb41-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x, title.crew,  <span class="at">by=</span><span class="st">&quot;tconst&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="results.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(directors)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-7"><a href="results.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(directors <span class="sc">%in%</span> top_10<span class="sc">$</span>directors) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="results.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(name.basics, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;directors&quot;</span><span class="ot">=</span><span class="st">&quot;nconst&quot;</span>))</span>
<span id="cb41-9"><a href="results.html#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="results.html#cb41-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> </span>
<span id="cb41-11"><a href="results.html#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genres.x <span class="sc">%in%</span> main_genres, <span class="fu">is.na</span>(numVotes)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="fu">is.na</span>(averageRating)<span class="sc">==</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="results.html#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalratings=</span>numVotes<span class="sc">*</span>averageRating) <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="results.html#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(primaryName, genres.x) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="results.html#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rating2=</span><span class="fu">sum</span>(totalratings)<span class="sc">/</span><span class="fu">sum</span>(numVotes), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="results.html#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb41-16"><a href="results.html#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="results.html#cb41-17" aria-hidden="true" tabindex="-1"></a>xlabels <span class="ot">=</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb41-18"><a href="results.html#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="results.html#cb41-19" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(primaryName, <span class="fu">fct_rev</span>(<span class="fu">factor</span>(genres.x)), <span class="at">fill =</span> rating2)) <span class="sc">+</span></span>
<span id="cb41-20"><a href="results.html#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="results.html#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb41-22"><a href="results.html#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;blue&quot;</span>, <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">title=</span><span class="st">&#39;Weighted </span><span class="sc">\n</span><span class="st"> Rating&#39;</span>)) <span class="sc">+</span></span>
<span id="cb41-23"><a href="results.html#cb41-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-24"><a href="results.html#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-25"><a href="results.html#cb41-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span> (<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) </span>
<span id="cb41-26"><a href="results.html#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="results.html#cb41-27" aria-hidden="true" tabindex="-1"></a>main_genres <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&#39;Drama&#39;</span>,<span class="st">&#39;Comedy&#39;</span>,<span class="st">&#39;Music&#39;</span>,<span class="st">&#39;Documentary&#39;</span>,<span class="st">&#39;Action&#39;</span>, <span class="st">&#39;Romance&#39;</span>, <span class="st">&quot;Thriller&quot;</span>,<span class="st">&#39;Crime&#39;</span>, <span class="st">&#39;Horror&#39;</span>, <span class="st">&#39;Adventure&#39;</span>, <span class="st">&#39;Biography&#39;</span>, <span class="st">&#39;Sci-Fi&#39;</span>)</span>
<span id="cb41-28"><a href="results.html#cb41-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-29"><a href="results.html#cb41-29" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> </span>
<span id="cb41-30"><a href="results.html#cb41-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genres.x <span class="sc">%in%</span> main_genres, <span class="fu">is.na</span>(numVotes)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="fu">is.na</span>(averageRating)<span class="sc">==</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="results.html#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(primaryName, genres.x) <span class="sc">%&gt;%</span></span>
<span id="cb41-32"><a href="results.html#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rating=</span><span class="fu">mean</span>(averageRating), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-33"><a href="results.html#cb41-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb41-34"><a href="results.html#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="results.html#cb41-35" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(primaryName, <span class="fu">fct_rev</span>(<span class="fu">factor</span>(genres.x)), <span class="at">fill =</span> rating)) <span class="sc">+</span></span>
<span id="cb41-36"><a href="results.html#cb41-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-37"><a href="results.html#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb41-38"><a href="results.html#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;white&quot;</span>, <span class="at">high=</span><span class="st">&quot;blue&quot;</span>, <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">title=</span><span class="st">&#39;Avg Rating&#39;</span>)) <span class="sc">+</span></span>
<span id="cb41-39"><a href="results.html#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-40"><a href="results.html#cb41-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-41"><a href="results.html#cb41-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span> (<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) </span>
<span id="cb41-42"><a href="results.html#cb41-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-43"><a href="results.html#cb41-43" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">/</span> g2  <span class="sc">+</span>    <span class="co"># Create grid of plots with title</span></span>
<span id="cb41-44"><a href="results.html#cb41-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Ratings of different genres&quot;</span>, <span class="at">caption=</span><span class="st">&quot;directors&quot;</span>,</span>
<span id="cb41-45"><a href="results.html#cb41-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">plot.caption =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">vjust=</span><span class="dv">6</span>) ))</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-48-1.png" width="960" /></p>
<p>The average rating graph are almost the same as the weighted rating graph. From the two graphs, it is obvious that there is no apparent relationship between the number of movies a director made and the rating he got. You can see director Godfrey Ho has about average rate 4-5 in all genres, which is not a high rating. In ‘Action’ movies, He also did not have high ratings, which implies that it does not mean the more ‘Action’ movies you made, the higher rating you can get.</p>
<p>However, there is an interesting phenomenon. You can see that for each director, there has a relationship between different genres. Let’s see director Cheh Chang. The overall rating of his movies is about 6-7. There does not have a big gap between the highest average ratings and the lowest ratings.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="missing-values-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-component.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YiranShu/imdbdata/edit/main/05-results.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/YiranShu/imdbdata/blob/main/05-results.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
